---
output:
  html_document: default
  pdf_document: default
---
```{r, echo=FALSE}
knitr::opts_chunk$set(error = TRUE)
```

# Outcome {#outcome}

This chapter focusses on the first application of the D-score: the D-score as neurocognitive outcome at 1000 days. In this chapter, we show how the D-score is calculated, demonstrate how to work with the D-score package, and how the D-score can be used as neurocognitive outcome in three different populations. First, the calculations behind the D-score are explained step-by-step and how to do this with the D-score package by means of two example children. Thereafter, the D-scores will be calculated for three different populations at the age of two years: the reference population, population of preterm children, and population of children in LMIC. 


## D-score of reference children at 2 years (PD)

A reference sample was obtained from the Social Medical Survey of Children Attending Child Health Clinics (SMOCC) cohort, a nationally representative cohort of 2,151 children born in The Netherlands during 1988–1989 [@herngreen1994] . Of this cohort, general characteristics and developmental milestones of the Dutch Development Instrument at 2y of age (range 22-26 months) were available for 1,578 children. 

During the SMOCC study the milestones of the current wave and the next wave were assessed [@herngreen1994]. With the SMOCC dataset we can compare the D-scores calculated by making use of calibrated milestones (the current wave milestones) with the D-scores calculated by making use of non-calibrated milestones (the next wave milestones). These D-scores for children of the age of 2 and 3 months (wave 2 and 3) are plotted against IQ at 5 years in figure \@ref(fig:dscoresnw). The continuous variable IQ at 5 years allows for nice visualization of the variation in D-scores. Moreover, the densities of the D-score are given at the bottom of the plots showing the distribution of the values of the D-score.


```{r, echo=FALSE, message=FALSE, warning = FALSE}
library(gridExtra)
library(dplyr)
# data.long <- haven::read_sav("//365tno.sharepoint.com@SSL/DavWWWRoot/teams/P060.33452/TeamDocuments/Team/Work/Booklets/Data/smocc_long3.sav")
data.long <- haven::read_sav("data-raw/data/smocc/smocc_long3.sav")
data.long$scores_false <- data.long$scores_false - 1
data.long$scores_false_nw <- data.long$scores_false_nw - 1
data.long <- as_tibble(data.long)

data.long$wave <- factor(data.long$wave)
data.long1 <- data.long[!is.na(data.long$IQ), ]
data.long1 <- data.long1[!is.na(data.long1$dscore), ]
data.long1$scores_false <- as.factor(data.long1$scores_false) 
data.long1$scores_false_nw <- as.factor(data.long1$scores_false_nw) 
```

```{r, echo=FALSE, message=FALSE, warning = FALSE}
library(ggplot2)

p2 <- ggplot()+
  geom_point(data=subset(data.long1, wave == c(2)), aes(dscore, IQ, group = wave, col=scores_false), show.legend=F, size = 1)+ 
  scale_colour_manual(values = c("0" = "springgreen3", "1" = "gold2", "2" = "darkorange2", "3" = "red3", "4" = "deeppink3", "5" = "purple3","6" = "steelblue4", "7" = "grey40"))+
  coord_cartesian(xlim=c(0, 75)) +
  scale_x_continuous(name = "D-score (2 month milestones) ") +
  facet_grid(. ~ wave) +
  geom_density(data=subset(data.long1, wave == c(2)),   
               aes(dscore, y = ..density..*100),
               show.legend = F) +
  theme(legend.position = "none") + 
  scale_y_continuous(sec.axis = sec_axis(~./100, name = "Density D-score"))

p3 <- ggplot()+
  geom_point(data=subset(data.long1, wave == c(3)), aes(dscore, IQ, group = wave, col=scores_false), show.legend=F, size = 1)+ 
  scale_colour_manual(values = c("0" = "springgreen3", "1" = "gold2", "2" = "darkorange2", "3" = "red3", "4" = "deeppink3", "5" = "purple3","6" = "steelblue4", "7" = "grey40"))+
  coord_cartesian(xlim=c(0, 75)) +
  scale_x_continuous(name = "D-score (3 month milestones) ") +
  facet_grid(. ~ wave) +
  geom_density(data=subset(data.long1, wave == c(3)),   
               aes(dscore, y = ..density..*100),
               show.legend = F) +
  theme(legend.position = "none") + 
  scale_y_continuous(sec.axis = sec_axis(~./100, name = "Density D-score"))
  

#D-score next wave
p2.nw <- ggplot()+
  geom_point(data=subset(data.long1, wave == c(2)), aes(dscore.nw, IQ, group = wave, col=scores_false_nw), show.legend=F, size = 1)+ 
  scale_colour_manual(values = c("0" = "springgreen3", "1" = "gold2", "2" = "darkorange2", "3" = "red3", "4" = "deeppink3", "5" = "purple3","6" = "steelblue4", "7" = "grey40"))+
  coord_cartesian(xlim=c(0, 75)) +
  scale_x_continuous(name = "D-score (3 month milestones) ") +
  facet_grid(. ~ wave) +
  geom_density(data=subset(data.long1, wave == c(2)),   
               aes(dscore.nw, y = ..density..*100),
               show.legend = F) +
  theme(legend.position = "none") + 
  scale_y_continuous(sec.axis = sec_axis(~./100, name = "Density D-score"))

p3.nw <- ggplot()+
  geom_point(data=subset(data.long1, wave == c(3)), aes(dscore.nw, IQ, group = wave, col=scores_false_nw), show.legend=T, size = 1)+ 
  scale_colour_manual(values = c("0" = "springgreen3", "1" = "gold2", "2" = "darkorange2", "3" = "red3", "4" = "deeppink3", "5" = "purple3","6" = "steelblue4", "7" = "grey40"), 
                      name = "Number of negative scores")+
  coord_cartesian(xlim=c(0, 75)) +
  scale_x_continuous(name = "D-score (6 month milestones) ") +
  facet_grid(. ~ wave) +
  geom_density(data=subset(data.long1, wave == c(3)),   
               aes(dscore.nw, y = ..density..*100),
               show.legend = F) + 
  scale_y_continuous(sec.axis = sec_axis(~./100, name = "Density D-score"))
```

```{r, dscoresnw, echo = FALSE, message=FALSE, warning=FALSE, fig.cap="\\label{fig:dscoresnw} Comparison of the D-scores calculated by calibrated and non-calibrated milestones at the age of 2 months (Wave 2) and 3 months (Wave 3)"}
library(ggpubr)
ggarrange(p2, p2.nw, p3, p3.nw, ncol=2, nrow=2, common.legend = TRUE, legend="bottom")

```

The colours of the dots in figure \@ref(fig:dscoresnw) indicate the number of negative scores on the milestones: note that the number of milestones can differ per wave. Wave 2 has two milestones, Wave 3 has five milestones and Wave 4 has six milestones of the DDI. The variation in the D-score of the children with the same number of negative scores (the same colour of dots) is caused by variation in age. Since the D-score is calculated by using an age-dependent prior, younger children in the same wave with the same scores will have a lower D-score.

Moreover, the plots on the left in figure \@ref(fig:dscoresnw) show that using calibrated milestones leads to a gap between the green dots (zero negative scores) and the yellow dots (one negative score). Since 90\% of the children should be able to get a positive score on each of the milestones implies that the milestones should be quite easy for the children of that age. So, when a child gets a negative score, it should have an impact on the D-score. For example, when a child of the age of 2 months has one negative score, his/her D-score immediately drops from around 20 to around 14. Which implicates that if you use the 2 month milestones for a child of the age of 2 months he/she will never have a D-score in the range of 15 - 18. This shows that it is also possible to have a ceiling/bottom within the D-score scale. This would be ideal in screening purposes, were you want to find children that have a delay in their development in comparison to their peers.

In addition, the plots on the right in figure \@ref(fig:dscoresnw), show the D-scores when non-calibrated milestones (the milestones of the next wave) are used. For the DDI, on average, around 50\% of the children should be able to get a positive score in this situation. For example, 50\% of the children of the age of 2 months should be able to get a positive score on the 3 month milestones. Since these milestones are considered to be more difficult, a negative score on one of the milestones will have a smaller effect on the D-score. Hence, the gap we saw before between the green and yellow dots disappears. Furthermore, there is more variation in the D-scores and the ceiling/bottom within the D-score scale disappears.

Previously described phenomena are also visible in the densities of the D-scores. When the D-scores are calculated with the calibrated milestones, the left plots in figure \@ref(fig:dscoresnw), the density consists (at least) of two (small) peaks. While the D-scores calculated with non-calibrated milestones, the plots on the right, show a broader variation in the values of the D-score. Note, that the density of the D-score in the plot on the bottom right also shows the bottom effect of the D-score: the D-score is at least equal to 20. A lower D-score is not possible with this set of milestones at the age of 3 months. 

Linear regression analyses were performed with DAZ as outcome and the indicators as predictors. Calculation of the DAZ was unadjusted for gestational age.


```{r, eval=FALSE, echo=FALSE, warning=FALSE, message=FALSE}
#D-scores plot
p.dscore <- ggplot(data.long1, aes(age, dscore, group = wave)) +
  geom_point(aes(col=scores_false), show.legend=F, size = 1 )+ 
  scale_colour_manual(values = c("0" = "springgreen3", "1" = "gold2", "2" = "darkorange2", "3" = "red3", "4" = "deeppink3", "5" = "purple3","6" = "steelblue4", "7" = "grey40"))+
  coord_cartesian(xlim=c(0, 25)) +
  scale_y_continuous(name = "D") +
  scale_x_continuous(name = "age") 
p.dscore

p.dscore.nw <- ggplot(data.long1, aes(age, dscore.nw, group = wave)) +
  geom_point(aes(col=scores_false_nw), show.legend=F, size = 1 )+ 
  scale_colour_manual(values = c("0" = "springgreen3", "1" = "gold2", "2" = "darkorange2", "3" = "red3", "4" = "deeppink3", "5" = "purple3","6" = "steelblue4", "7" = "grey40"))+
  coord_cartesian(xlim=c(0, 25)) +
  scale_y_continuous(name = "D") +
  scale_x_continuous(name = "age") 
p.dscore.nw

resultsSMOCC <- data.frame(a = c("Area of Residence","rural", "semi-urban" , "urban", "metropolitan", "Maternal education (in years)", "Paternal education (in years)", "Maternal age (in years)", "Gestational age (in weeks)", "Gestational age (in categories)", "$\\geq 37$ weeks", "$\\geq 32 - 37$ weeks", "$<32$ weeks*", "Gender", "boys", "girls", "Birthweight (in kg)","Birthweight (in categories)", "$\\geq 2500$ grams", "$\\geq 1500 - <2500$ grams", "$<1500$ grams", "Birth size (in cm)", "Apgar score after 1 min", "$<5$", "$\\geq 5$", "Apgar score after 5 min", "$<7$", "$\\geq 7$"), 
                b = c(" ","$15$", "$1257$" , "$294$", "$0$", "$1559$", "$1555$", "$1577$", "$1578$", " ", "$1495$", "$78$", "$5$", " ", "$768", "$810$", "$1578$"," ", "$1485$", "$85$", "$8$", "$1381$", " ", "$28$", "$1304$", " ", "$15$", "$1336$"),
                c = c( " ","$1.0%$", "$80.3%$" , "$18.8%$", "$0.0%$", "$13 (2.3)$", "$14 (2.6)$", "$30 (4.5)$", "$40 (1.8)$", " ", "$94.7%$", "$4.9%$", "$0.3%$", " ", "$48.7%$", "$51.3%$", "$3.419 (0.559)$"," ", "$94.1%$", "$5.4%$", "$0.5%$", "$51 (2.6)$", " ", "$2.1%$", "$97.8%$", " ", "$1.1%$", "$98.9%$"),
                d = c(" ","$0.2842 (0.2469)$", "$0$", "$0.0723 (0.0616)$", " ", "$0.0805 (0.0103)$", "$0.0546 (0.0092)$", "$0.0007 (0.0054)$", "$0.0675 (0.0130)$", " ", "$0$", "$-0.3786 (0.1098)$","$-1.2844 (0.4236)$", " ", "$-0.2896 (0.0474)$", "$0$", "$0.1234 (0.0427)$"," ", "$0$", "$-0.2454 (0.1057)$", "$-0.9537 (0.3361)$", "$0.0163 (0.0097)$", " ", "$0.0493 (0.178)$", "$0$", " ", "$0.1493 (0.2422)$", "$0$"),
                e = c(" ","$1.15$", " " , "$1.17$", " ", "$7.84$", "$5.91$", "$0.13$", "$5.18$", " ", " ", "$-3.45$", "$-3.03$", " ", "$-6.11$", " ", "$2.89$"," ", " ", "$-2.32$", "$-2.84$", "$1.68$", " ", "$0.28$", " ", " ", "$0.62$", " "),
               f = c(" ","$0.25$", " " , "$0.24$", " ", "$<.001$", "$<.001$", "$0.90$", "$<.001$", " ", " ", "$<.001$", "$0.002$", " ", "$<.001$", " ", "$0.004$"," ", " ", "$0.0204$", "$0.0046$", "$0.093$", " ", "$0.78$", " ", " ", "$0.54$", " "))
```

## D-score of reference children at 2 years (PD)

**Data**

**Conclusions**

Maternal and paternal education, gestational age, gender and birthweight were significantly associated with DAZ at 2 years of age.  

Moreover, the plots on the left in figure \@ref(fig:dscoresnw) show that using calibrated milestones leads to a gap between the green dots (zero negative scores) and the yellow dots (one negative score). Since 90\% of the children should be able to get a positive score on each of the milestones implies that the milestones should be quite easy for the children of that age. So, when a child gets a negative score, it should have an impact on the D-score. For example, when a child of the age of 2 months has one negative score, his/her D-score immediately drops from around 20 to around 14. Which implicates that if you use the 2 month milestones for a child of the age of 2 months he/she will never have a D-score in the range of 15 - 18. This shows that it is also possible to have a ceiling/bottom within the D-score scale. This would be ideal in screening purposes, were you want to find children that have a delay in their development in comparison to their peers.

In addition, the plots on the right in figure \@ref(fig:dscoresnw), show the D-scores when non-calibrated milestones (the milestones of the next wave) are used. For the DDI, on average, around 50\% of the children should be able to get a positive score in this situation. For example, 50\% of the children of the age of 2 months should be able to get a positive score on the 3 month milestones. Since these milestones are considered to be more difficult, a negative score on one of the milestones will have a smaller effect on the D-score. Hence, the gap we saw before between the green and yellow dots disappears. Furthermore, there is more variation in the D-scores and the ceiling/bottom within the D-score scale disappears.

Previously described phenomena are also visible in the densities of the D-scores. When the D-scores are calculated with the calibrated milestones, the left plots in figure \@ref(fig:dscoresnw), the density consists (at least) of two (small) peaks. While the D-scores calculated with non-calibrated milestones, the plots on the right, show a broader variation in the values of the D-score. Note, that the density of the D-score in the plot on the bottom right also shows the bottom effect of the D-score: the D-score is at least equal to 20. A lower D-score is not possible with this set of milestones at the age of 3 months. 


```{r, eval=FALSE, echo=FALSE, warning=FALSE, message=FALSE}
#D-scores plot
p.dscore <- ggplot(data.long1, aes(age, dscore, group = wave)) +
  geom_point(aes(col=scores_false), show.legend=F, size = 1 )+ 
  scale_colour_manual(values = c("0" = "springgreen3", "1" = "gold2", "2" = "darkorange2", "3" = "red3", "4" = "deeppink3", "5" = "purple3","6" = "steelblue4", "7" = "grey40"))+
  coord_cartesian(xlim=c(0, 25)) +
  scale_y_continuous(name = "D") +
  scale_x_continuous(name = "age") 
p.dscore

p.dscore.nw <- ggplot(data.long1, aes(age, dscore.nw, group = wave)) +
  geom_point(aes(col=scores_false_nw), show.legend=F, size = 1 )+ 
  scale_colour_manual(values = c("0" = "springgreen3", "1" = "gold2", "2" = "darkorange2", "3" = "red3", "4" = "deeppink3", "5" = "purple3","6" = "steelblue4", "7" = "grey40"))+
  coord_cartesian(xlim=c(0, 25)) +
  scale_y_continuous(name = "D") +
  scale_x_continuous(name = "age") 
p.dscore.nw
```


## D-score of reference children at 2 years (PD)

**Data**

A reference sample was obtained from the Social Medical Survey of Children Attending Child Health Clinics (SMOCC) cohort, a nationally representative cohort of 2,151 children born in The Netherlands during 1988–1989 [@herngreen1994]. Of this cohort, general characteristics and developmental milestones of the Dutch Development Instrument at 2y of age (range 22-26 months) were available for 1,583 children.

**Methods**

Several characteristics were selected from the SMOCC cohort.  The following indicators are in agreement with the Global Indicators Project:

- Area of residence:
    - rural: <2,000 inhabitants
    - semi-urban: [2000, 50,000] inhabitants
    - urban: 50,000 – 1 million inhabitants
    - metropolitan: >1 million

-	Number of years of education by the mother (in years)
-	Child related factors:
     - Gestational age (In weeks and in categories of very preterm (<32 weeks), preterm (<37 weeks) and term birth (≥37 weeks))
     - Gender (boys vs girls)
     - Birthweight (in grams)
     - Birth size (in cm)

We also added the following indicators from the SMOCC study:

-	Paternal education (in years)
-	Maternal age (in years)
-	Apgar score after 1 min < 5 (yes vs no)
-	Apgar score after 5 min < 7 (yes vs no)

**Results**

```{r, echo=FALSE}

resultsSMOCC <- data.frame(a = c("Area of Residence","rural", "semi-urban" , "urban", "metropolitan", "Maternal education (in years)", "Paternal education (in years)", "Maternal age (in years)", "Gestational age (in weeks)", "Gestational age (in categories)", "$\\geq 37$ weeks", "$\\geq 32 - 37$ weeks", "$<32$ weeks*", "Gender", "boys", "girls", "Birthweight (in kg)","Birthweight (in categories)", "$\\geq 2500$ grams", "$\\geq 1500 - <2500$ grams", "$<1500$ grams", "Birth size (in cm)", "Apgar score after 1 min", "$<5$", "$\\geq 5$", "Apgar score after 5 min", "$<7$", "$\\geq 7$"),
                b = c(" ","$15$", "$1262$" , "$294$", "$0$", "$1564$", "$1560$", "$1582$", "$1583$", " ", "$1500$", "$78$", "$5$", " ", "$771$", "$812$", "$1583$"," ", "$1490$", "$85$", "$8$", "$1383$", " ", "$29$", "$1306$", " ", "$15$", "$1339$"),
                c = c( " ","$1.0%$", "$80.3%$" , "$18.7%$", "$0.0%$", "$13 (2.3)$", "$14 (2.6)$", "$30 (4.5)$", "$40 (1.8)$", " ", "$94.8%$", "$4.9%$", "$0.3%$", " ", "$51.0%$", "$49.0%$", "$3.419 (0.559)$"," ", "$94.1%$", "$5.4%$", "$0.5%$", "$51 (2.6)$", " ", "$2.2%$", "$97.8%$", " ", "$1.1%$", "$98.9%$"),
                d = c(" ","$0.2838 (0.2467)$", "$0$", "$0.0719 (0.0615)$", " ", "$0.0802 (0.0102)$", "$0.0538 (0.0092)$", "$0.0005 (0.0054)$", "$0.0676 (0.0130)$", " ", "$0$", "$-0.3788 (0.1097)$","$-1.2846 (0.4233)$", " ", "$-0.2904 (0.0473)$", "$0$", "$0.1226 (0.0427)$"," ", "$0$", "$-0.2456 (0.1056)$", "$-0.9539 (0.3358)$", "$0.0165 (0.0097)$", " ", "$0.0524 (0.1752)$", "$0$", " ", "$0.1497 (0.2420)$", "$0$"),
                e = c(" ","$1.15$", " " , "$1.17$", " ", "$7.83$", "$5.83$", "$0.10$", "$5.20$", " ", " ", "$-3.45$", "$-3.03$", " ", "$-6.15$", " ", "$2.87$"," ", " ", "$-2.33$", "$-2.84$", "$1.70$", " ", "$0.3$", " ", " ", "$0.62$", " "),
               f = c(" ","$0.25$", " " , "$0.24$", " ", "$<.001$", "$<.001$", "$0.92$", "$<.001$", " ", " ", "$<.001$", "$0.002$", " ", "$<.001$", " ", "$0.0041$"," ", " ", "$0.0202$", "$0.0046$", "$0.089$", " ", "$0.76$", " ", " ", "$0.54$", " "))

knitr::kable(resultsSMOCC, caption = "Results SMOCC", booktabs = TRUE, digits = 4, col.names = c("Indicators","n","$%$ or mean(SD)", "Model DAZ Coefficient (SE)","Model DAZ t-statistics","Model DAZ p-value"))
```


```{r, echo=FALSE, eval = FALSE}
#Script van Stef:
library("ddata")
library("dscore")
library("dmetric")
studies <- c("Netherlands 1", "Netherlands 2")
data <- get_gcdg(study = studies, min_cat = 10, adm = TRUE, cov = TRUE)
items <- intersect(item_names(study = studies), names(data))
nlbank <- dscore::itembank
d_dutch <- calculate_dscore(data = data, items = items,
                            itembank = nlbank, lexicon = "gcdg")
ref <- dscore::gcdg_reference
d_dutch$daz <- with(d_dutch, dscore::daz(d = d, x = age / 12, ref = ref))
n_items <- data.frame(id = data$id, age = data$age,
                      n = rowSums(!is.na(data[, items])))
d_dutch <- dplyr::left_join(d_dutch, n_items, by = c("id", "age"))
```

**How to adjust development for age of gestation?**

Developmental milestones can be assessed at several chronological ages (defined as age since birth, or postnatal age) to identify very preterm children who have developmental delay and who would benefit from stimulation programs. However, assessment of very preterm children at the same chronological age as term children may cause overdiagnosis of developmental delay in very preterm children and excessive referral for stimulation programs. Very preterm children may require additional time, determined by a factor that considers the difference between gestational age at birth ($GA_{birth}$) vs 40 wk ($GA_{birth}$ for normal term birth), to enable development equivalent to that of normal term birth children. Several authors have proposed full or half correction of chronological age of very preterm birth children to provide a realistic evaluation of age-appropriate milestones; e.g. compare milestones for a child born at $GA_{birth}$ 30 wk vs a normal term child when the chronological age is 10 (full correction, i.e. 40 minus 30 wk) or 5 wk (half correction, i.e. 40 minus 35 wk) lower for the term than very preterm child. The Dutch Development Instrument (DDI) – a modification of the Gesell test – is used in preventive child health care to assess development from birth to chronological age 4 y.

**Data**

In 1983, data were collected for 1338 infants in the Netherlands who had very preterm birth ($GA_{birth} \geq$ 25 and < 32 wk) or very low birth weight (birth weight < 1500 g) (Project On Preterm and Small for Gestational Age Infants [POPS]).

**Methods**

The $GA_{birth}$ was determined from the best obstetric estimate, including last menstrual period, results of pregnancy testing, and ultrasonography findings.
We evaluated development from birth to chronological age 2.5 y in 258 children who had very preterm birth (<32 wk) and no handicaps such as retardation (3 or 4 months retarded or Developmental Quotient between 80 and 90), neurologic disorder, visual or hearing defects, or psychosocial problems. For the calculation of DAZ, the uncorrected and several corrected chronological ages were used according to the equation:

Corrected chronological age ($d$) = uncorrected chronological age ($d$) - ($X_i × 7 × [40 - GA_{birth}(wk)]$)

where the correction factor $X_i$ ranged from full ($X_i = 1$) through half ($X_i = 0.5$) and no correction ($X_i = 0$).
Development was considered equal to the general Dutch population when mean DAZ = 0.

**Results**

Mean DAZ $\pm$ SD for chronological age with correction by $X_i = 1.0$ were:

-	Uncorrected chronological age 19-26 wk: $0.67 \pm 1$;
-	Uncorrected chronological age 32-40 wk: $-0.1 \pm 1$;
-	Uncorrected chronological age 59-66 wk: $-0.1 \pm 1$;
-	Uncorrected chronological age 111-119 wk: $0.1 \pm 1$.

Mean DAZ $\pm$ SD for chronological age with correction by $X_i = 0.75$ was:

-	Uncorrected chronological age 19-26 wk: $-0.1 \pm 1$.

Mean DAZ $\pm$ SD for chronological age with no correction ($X_i = 0$) were:

-	Uncorrected chronological age 19-26 wk: $-1.8 \pm 1$;
-	Uncorrected chronological age 32-40 wk: $-1.9 \pm 1$;
-	Uncorrected chronological age 59-66 wk: $-1.1 \pm 1$;
-	Uncorrected chronological age 111-119 wk: $-0.4 \pm 1$.

**Conclusions**

Compared with the general population, more very preterm children reached developmental milestones within chronological age 26 wk when chronological age was fully corrected, and fewer preterm children reached the milestones when uncorrected chronological age was used; fewer children reached the milestones when 0.5 correction for $GA_{birth}$ was used, and similar proportions were observed when 0.75 correction for $GA_{birth}$ was used within the first 26 weeks after birth. After chronological age 26 wk, similar proportions were observed between very preterm and full term children when chronological age was fully corrected for $GA_{birth}$. We recommend 0.75 correction of chronological age before uncorrected chronological age 26 wk and full correction for uncorrected chronological age 26 to 119 wk.

**Impact of characteristics on the DAZ in preterm children**

**Data**

When we select the DAZ at 2y of fully corrected chronological age (range 22-26 months) within the POPS study, 199 children were available.

**Methods**

Several characteristics were selected from the POPS cohort.  The following indicators are in agreement with the Global Indicators Project:

- Area of residence:
    - rural: <2,000 inhabitants
    - semi-urban: [2000, 50,000] inhabitants
    - urban: 50,000 – 1 million inhabitants
    - metropolitan: >1 million

-	Number of years of education by the mother (in years)
-	Child related factors:
     - Gestational age (In weeks and in categories of very preterm (<32 weeks), preterm (<37 weeks) and term birth (≥37 weeks))
     - Gender (boys vs girls)
     - Birthweight (in grams)
     - Birth size (in cm)

We also added the following indicators from the POPS study:

=======

Corrected chronological age ($d$) = uncorrected chronological age ($d$) - ($X_i × 7 × [40 - GA_{birth}(wk)]$)

where the correction factor $X_i$ ranged from full ($X_i = 1$) through half ($X_i = 0.5$) and no correction ($X_i = 0$).
Development was considered equal to the general Dutch population when mean DAZ = 0.

**Results**

Mean DAZ $\pm$ SD for chronological age with correction by $X_i = 1.0$ were:

-	Uncorrected chronological age 19-26 wk: $0.67 \pm 1$;
-	Uncorrected chronological age 32-40 wk: $-0.1 \pm 1$;
-	Uncorrected chronological age 59-66 wk: $-0.1 \pm 1$;
-	Uncorrected chronological age 111-119 wk: $0.1 \pm 1$.

Mean DAZ $\pm$ SD for chronological age with correction by $X_i = 0.75$ was:

-	Uncorrected chronological age 19-26 wk: $-0.1 \pm 1$.

Mean DAZ $\pm$ SD for chronological age with no correction ($X_i = 0$) were:

-	Uncorrected chronological age 19-26 wk: $-1.8 \pm 1$;
-	Uncorrected chronological age 32-40 wk: $-1.9 \pm 1$;
-	Uncorrected chronological age 59-66 wk: $-1.1 \pm 1$;
-	Uncorrected chronological age 111-119 wk: $-0.4 \pm 1$.

**Conclusions**

Compared with the general population, more very preterm children reached developmental milestones within chronological age 26 wk when chronological age was fully corrected, and fewer preterm children reached the milestones when uncorrected chronological age was used; fewer children reached the milestones when 0.5 correction for $GA_{birth}$ was used, and similar proportions were observed when 0.75 correction for $GA_{birth}$ was used within the first 26 weeks after birth. After chronological age 26 wk, similar proportions were observed between very preterm and full term children when chronological age was fully corrected for $GA_{birth}$. We recommend 0.75 correction of chronological age before uncorrected chronological age 26 wk and full correction for uncorrected chronological age 26 to 119 wk.

**Impact of characteristics on the DAZ in preterm children**

**Data**

When we select the DAZ at 2y of fully corrected chronological age (range 22-26 months) within the POPS study, 199 children were available.

**Methods**

Several characteristics were selected from the POPS cohort.  The following indicators are in agreement with the Global Indicators Project:

- Area of residence:
    - rural: <2,000 inhabitants
    - semi-urban: [2000, 50,000] inhabitants
    - urban: 50,000 – 1 million inhabitants
    - metropolitan: >1 million

-	Number of years of education by the mother (in years)
-	Child related factors:
     - Gestational age (In weeks and in categories of very preterm (<32 weeks), preterm (<37 weeks) and term birth (≥37 weeks))
     - Gender (boys vs girls)
     - Birthweight (in grams)
     - Birth size (in cm)

We also added the following indicators from the POPS study:

-	Paternal education (in years)
-	Maternal age (in years)
-	Apgar score after 1 min < 5 (yes vs no)
-	Apgar score after 5 min < 7 (yes vs no)

Linear regression analyses were performed with DAZ as outcome and the indicators as predictors. Calculation of the DAZ was based on fully corrected chronological age.


**Results**

```{r, echo=FALSE}

resultsPOPS<- data.frame(a = c("Area of Residence","rural", "semi-urban" , "urban", "metropolitan", "Maternal education (in years)", "Paternal education (in years)", "Maternal age (in years)", "Gestational age (in weeks)", "Gestational age (in categories)", "$\\geq 37$ weeks", "$\\geq 32 - 37$ weeks", "$<32$ weeks*", "Gender", "boys", "girls", "Birthweight (in kg)","Birthweight (in categories)", "$\\geq 2500$ grams", "$\\geq 1500 - <2500$ grams", "$<1500$ grams", "Birth size (in cm)", "Apgar score after 1 min", "$<5$", "$\\geq 5$", "Apgar score after 5 min", "$<7$", "$\\geq 7$"),
                b = c(" ","$1$", "$120$" , "$71$", "$0$", "$152$", "$156$", "$193$", "$199$", " ", "$0$", "$0$", "$199$", " ", "$88$", "$111$", "$199$"," ", "$1$", "$65$", "$133$", "$165$", " ", "$44$", "$147$", " ", "$16$", "$160$"),
                c = c( " ","$0.5%$", "$62.5%$" , "$37.0%$", "$0%$", "$13.4 (2.2)$", "$14.1 (2.4)$", "$27.5 (4.4)$", "$30.1 (1.4)$", " ", "$0%$", "$0%$", "$100%$", " ", "$44.2%$", "$55.8%$", "$1.371 (0.341)$"," ", "$0.5%$", "$32.7%$", "$66.8%$", "$39.6 (3.2)$", " ", "$77.0%$", "$23.0%$", " ", "$9.1%$", "$90.9%$"),
                d = c(" ","", "$0$", "$-0.1561 (0.1661)$", " ", "$0.07417 (0.03897)$", "$0.08542 (0.03458)$", "$0.01462 (0.01810)$", "$0.02039 (0.05784)$", " ", " ", " "," ", " ", "$-0.09883 (0.15862)$", "$0$", "$0.4280  (0.2299)$"," ", "", "$0.14866 (0.16782)$", "$0$", "$0.01707 (0.02706)$", " ", "$-0.13315 (0.19208)$", "$0$", " ", "$0.56013 (0.28326)$", "$0$"),
                e = c(" "," "," " , "$-0.939$", " ", "$1.903$", "$2.470$", "$0.808$", "$0.352$", " ", " ", " ", " "," ", " ","$0.623$","$1.862$"," "," ","$0.886$"," ","$0.631$", " ", "$-0.693$"," "," ","$1.977$", " "),
               f = c(" "," "," ","$0.349$" , " ","0.0589","$0.0146$","$0.420$","$0.725$", " ", " ", " ", " ", " ", " ", "$0.534$", "$0.0641$", " ", " ","$0.377$", " ", "$0.529$", " ","$0.4890$", " ", " ", "$0.0496$", " "))

knitr::kable(resultsPOPS, caption = "Results POPS", booktabs = TRUE, digits = 4, col.names = c("Indicators","n","$%$ or mean(SD)", "Model DAZ Coefficient (SE)","Model DAZ t-statistics","Model DAZ p-value"))
```

**Conclusions**

Paternal education and apgar score after 5 minutes below 7 were significantly associated with DAZ at 2 years of age.


## Usability and validity of the $D$-score in a low income country: The case of Togo

The $D$-score is intended as a universal measure of children’s development. There is ample research indicating that the $D$-score actually is a valid indicator of development in western European countries like the Netherlands. If the $D$-score is a universal measure it should be informative in low and middle income countries as well. However, little is known about the usability and validity of the $D$-score in such countries. The aim of the present study is to examine the usability and validity of the $D$-score in the western African country of Togo. Togo definitely qualifies as a low income country with a 2017 GNI per capita of $610 versus $46,180 in the Netherlands, and $744 for low income countries in general (data.worldbank.org).   
	To address this issue, we used data that were gathered by a French physician in Kpalimé, Togo. She set up a child health care system that was modeled after the Dutch preventive health care system. The system included the use of the *Dutch Development Instrument* (DDI; in Dutch: *Van Wiechenschema*) to assess whether children’s developmental progress is in the normal range. The DDI data were used to calculate the $D$-scores as well as the age-corrected z-score of the $D$-score relative to a Dutch sample (DAZ). These two indices are the dependent variables in the present study. Data were gathered from about 9747 individuals in the 0-18 age range, but for the present study we focus on data from children in the 0-4 age range because the DDI assessment system is meant for this age range.  
	Other available measures include father’s level of schooling, father’s number of children at the child’s first visit to the medical center, the APGAR score as a newborn, children’s weight, and the results of a physician’s neurological examination during visits to the health center. These variables are used to predict children’s $D$-scores and thereby to examine the $D$-score’s usability and validity in Togo.  

**Methods**  

*Participants*    
	Participants potentially included 1859 children in the 0-4 age range who paid at least one visit to the Kpalimé health center. Kpalimé is the fourth biggest town in Togo, but the health center also attracted parents and children from a wide surrounding rural area. Parents visited the health center for several reasons, including for a preventive health check or because of their child’s apparent health problems. The possibility of visiting the health center was made known to parents by information sessions for parents at primary schools. Parents paid a small amount of money per visiting child (about €4 for children of 4 years or older, and €0.80 for children younger than 4 years).  
	Because of limitations that are inherent to working in a low income country (limited access to the internet, computer failure) data of newly digitalized paper dossiers were sent to the Netherlands on a regular basis, but this practice unavoidably caused some unclarities and inconsistencies in the resulting dataset. Many of these could be solved, but time constraints prevented us from solving them all. Consequently, the data of .. potential participants (..%) were not yet included in the present study which leaves a dataset of 1659 (of 1644 NOG UITZOEKEN). Moreover $D$-scores could not be calculated when either age or DDI data were missing, which leaves a dataset of 2342 visits from 1522 children. The number of visits that parents of these children in the 0-4 age range paid to the health center varied from 1 – 9, but the majority of children were seen only once (n = 1146; 75.3%).  

*Measures*  
$D$-score  
$D$-scores were calculated based on a French-language version of the DDI assessment. As in the Dutch preventive health care system, the goal of administering the DDI assessment was to  distinguish children with developmental problems from normal children. This means that items were chosen such that 90% of the children is expected to pass on age-equivalent items. Generally, for children that did not pass items age-equivalent items, extra items meant for a lower age were assessed (with the exception that items meant for children younger than 15 months were never administered to children of age 15 months or older). Scores were strictly based on observations rather than on parent report. For the exact procedure to calculate $D$-scores based on DDI-scores, see chapter 5.  

Medical assessment  
At each visit a physician notated whether problems were observed regarding a wide range of health aspects including problems with reflexes and muscle tension. Also, weight was measured at each visit.

Background characteristics  
At the first visit of each child, the accompanying adult (mostly the mother) was asked to report on general background characteristics, including profession of the parents and the number of children each of the parents has (due to polygamy this number may differ between parents). As a measure of socio-economic status (SES) we constructed a dichotomous variable 'schooling of father' based on the reported profession of the father. As the main physician and founder of the medical center is familiar with the local culture and schooling system, she indicated which of the thirteen most common professions were likely to be schooled professions (i.e. need more than primary education). Fathers with one of these professions were classified as 'schooled'. When 'another profession' was marked, the father was categorized as unschooled.  
	Other background characteristics included gender of the child, number of children of the father at the moment of the first visit, and birth date. Age of the child at the moment of visiting was calculated based on the date of visit and the birth date. In Togo, medical information about a newborn is notated on a special card which parents receive. Parents were asked to take this card to the medical center; in this way information about the birth situation of part of the children was obtained, including 
	<!-- birth weight, gestational age (<37 weeks versus 37 weeks or more) and  (wordt in beschreven analyses niks mee gedaan gebruikt, dus niet noemen)-->
	APGAR scores at 1, 5 and 10 minutes after birth.  

*Procedure*  
Measures used in this study were assessed at the medical center in Kpalimé which parents visited with their children, and were part of a general preventive health assessment (including physical measurements of weight, height, and head size, a medical examination, a few blood tests, and a hearing test). Also, parents were asked to report on characteristics of the birth situation, previous health issues, nutrition situation, and background characteristics of the family.   
During the visits, medical assessment took place before assessment of the DDI assessment, and was conducted by the same physician. All assessments, including the DDI assessment, were either performed by the initiating physician and founder of the medical center, or by one of three local physicians trained to assess the DDI procedure. Resulting data of the assessment (including advice given and/or references to another professional) were documented in paper dossiers and in 2017 digitalized by four local assistants via software program EpiData. 
 
*Analyses*  
To assess the validity of the $D$-score in this population, we inspected scatterplots in which $D$-scores are plotted against age for all available visits, and in which children with neurological problems as observed by a physician are highlighted. It was expected that a curve is seen, with higher $D$-scores for older children, moreover children with very low $D$-scores for their age were expected to be assessed by the physician as having a neurological problem.
	Validity and usability of the $D$-score in this population would also be supported when known risk factors of developmental problems would be found to be predictors of a lower $D$-score in this population as well. Risk factors of interest are health problems of a newborn (as indicated by a less than optimal APGAR score at 10 minutes), and being underweighted. Furthermore, if a relation between underweight and a lower $D$-score is observed, it would also be interesting to see whether there is a relation between family size and $D$-score, as many children per family could be a cause of malnutrition. For this purpose children were classified as being part of a large family when the number of children of their father was 5 or more (at the moment of their first visit) versus 4 or less.  
  To assess which risk factors predict a lower than normal $D$-score, several regression analyses were conducted. Outcome variable is the Development - Age adjusted Z-score (DAZ) which tells how many standard deviations the $D$-score of the child deviates from his/her age mates. To calculate these z-scores, data of Dutch children are used as reference data. As this reference data is only available for children younger than age 2.78 years, only DAZ-scores could be calculated for age group 0 – 2.78, and therefore all regression analyses were performed for this subgroup.  
  For some of the risk factor variables data is only available for part of the children. In order to prevent a loss of power, for each risk factor separate regression analyses were conducted. In each regression sex and education level of father (schooled versus unschooled) were added as covariates (except for the regression where the relation between large families and the DAZ is analyzed, as family size and schooling may be confounded). As data from visits of the same children are not independent, regressions were performed on data with one visit per child only. All regression analyses were conducted twice: once with the data from the first visit of each child, and once with the last visit of each child.


**Results**  

<!-- nog ergens invoegen (in tekst?): n-en van de regressies ## -->

```{r, echo=FALSE}
library(ddata)
library(dscore)

# remove rows without valid agedays
togo <- TGO %>%
  filter(!is.na(agedays)) %>%
  arrange(id, agedays)

# calculate d and daz
itembank_NL <- dscore::itembank[,c("lex_gcdg", "tau")]
# lijkt erop togo ability() standaard de var 'age' gebruikt die in je data voorkomt, ook als je in de functie bij age="" een andere var opgegeven hebt die gebruikt moet worden
# zorg dat age echt age in jaren is: daarom overnemen van age_yr:
togo$age <- togo$age_yr
# calculate d
output_dscore <- ability(data=togo,
                              items = colnames(togo)[colnames(togo)%in%itembank$lex_gcdg],
                              age="age", 
                              metric="dscore",
                              itembank=itembank_NL,
                              lexicon="gcdg")
togo <- cbind(togo, output_dscore)
# b = d-score; rename 'b' as 'd'
colnames(togo)[grep("^b$", colnames(togo))] <- "d"

# calculate daz
ref_NL <- dscore::Dreference # reference group
# with 'x.unit' as 'year' as 'age' is in years
togo$daz <- daz(togo$d, togo$age, x.unit = "year", ref = ref_NL)

# select subset: only visits with d-scores (use in plots to prevent warnings about missing values)
togo_d <- togo[is.na(togo$d)==FALSE,]

# select subset with first daz-measurement per child
togo <- togo[order(togo$id, is.na(togo$daz), togo$agedays),]
togo$firstDAZ <- as.numeric(duplicated(togo$id)==FALSE)
togo_first <- togo[togo$firstDAZ==1,]

# select subset with last daz-measurement per child
togo <- togo[order(togo$id, is.na(togo$daz), -togo$agedays),]
togo$lastDAZ <- as.numeric(duplicated(togo$id)==FALSE)
togo_last <- togo[togo$lastDAZ==1,]


# select subset with first child measurement
# togo_first <- togo %>%
#   group_by(id) %>%
#   mutate(first = min(agedays)) %>%
#   filter(agedays == first)

# select subset with last child measurement (gives less cases as togo_last above as oldest children don't have a daz because no reference data was available above age 2.7)
# togo_last <- togo %>% 
#  group_by(id) %>%
#  mutate(last = max(agedays)) %>%
#  filter(agedays == last)


```


```{r, echo=FALSE}
# the continuous variables:
contvars <- c("age_yr", "d", "daz", "weight", "waz")
# the categorical variables:
catvars <- c("male", "prof_father_dich", "tonus.and.or.reflex.problems", 
             "apgar.10min.dich.less.than.10") # (below: recode 'apgar.10min.dich10')

# for descriptives use child level data: last visit with daz per child
curdat <- togo_last

# construct variable tonus.and.or.reflex.problems
curdat$tonus.and.or.reflex.problems <- NA
curdat$tonus.and.or.reflex.problems[
  is.na(curdat$neuro.reflex) == FALSE & is.na(curdat$neuro.tonus) == FALSE] <- 0
curdat$tonus.and.or.reflex.problems[
  is.na(curdat$neuro.reflex)==FALSE & 
    is.na(curdat$neuro.tonus)==FALSE & 
    (curdat$neuro.reflex==1 | curdat$neuro.tonus==1)] <- 1
# table(curdat$tonus.and.or.reflex.problems, useNA="ifany")
# table(curdat$neuro.tonus,
      # curdat$neuro.reflex, useNA="ifany")

# rescore variable 'apgar.10min.dich10' (to 1='not optimal' and 0='optimal')
curdat$apgar.10min.dich.less.than.10 <- NA
curdat$apgar.10min.dich.less.than.10[curdat$apgar.10min.dich10==1] <- 0
curdat$apgar.10min.dich.less.than.10[curdat$apgar.10min.dich10==0] <- 1
# table(curdat$apgar.10min.dich.less.than.10, curdat$apgar.10min.dich10, useNA="ifany")

# descriptives
# continuous variables:
v_n <- lapply(curdat[contvars], function(x) sum(is.na(x) == FALSE))
v_mean <- lapply(curdat[contvars], mean, na.rm = TRUE)
v_sd <- lapply(curdat[contvars], sd, na.rm=TRUE)
v_median <- lapply(curdat[contvars], median, na.rm=TRUE)
# v_min <- lapply(curdat[contvars], min, na.rm=TRUE)
# v_max <- lapply(curdat[contvars], max, na.rm=TRUE)

descr <- as.data.frame(cbind(v_n, v_mean, v_sd, v_median)) # , v_min, v_max)
descr <- format(descr, digits=2, nsmall=2)
row.names(descr) <- c("age (years)", "D-score","DAZ","weight (kg)", "weight z-score (age-corrected, WHO-reference data)")

knitr::kable(descr, 
             caption="Descriptives (last visit, for which daz could be calculated, per child)",
             col.names=c("N", "mean", "SD", "median"))
```

```{r echo = FALSE}
# voor de categorical vars:
v2_n <- lapply(curdat[catvars], function(x) sum(is.na(x)==FALSE))
v2_perc <- lapply(curdat[catvars], function(x) prop.table(table(x))["1"] * 100) # 

descr2 <- as.data.frame(cbind(v2_n, v2_perc))
descr2 <- format(descr2, digits=1, nsmall=1)
row.names(descr2) <- c("gender (% boys)", "fathers' schooling (% schooled)","muscle tension and/or reflex problems (% with problems, as observed by physician)","APGAR 10 min. (% with score <10)")

knitr::kable(descr2, 
             # caption="Descriptives", 
             col.names=c("N", "%"))


```

The relation between $D$-score and age can be found in figure .. As expected, a curve is seen, with higher ages related to higher $D$-scores. Also, it can be seen that several $D$-scores are below the curve, i.e. these children had lower $D$-scores than their age mates. In figure .. it can be seen that many of these lower than normal $D$-scores are not artefacts of the data, but belong to children that were observed to have reflex and/or muscle tension problems.  

```{r, echo=FALSE}

nvisits_d <- nrow(togo_d)
# of .. unique children:
n_d <- length(unique(togo_d[,"id"]))

library(ggplot2)

# whole group, all visits (i.e. can be more per child)
ggplot() +
  geom_point(data=togo_d,
             aes(x=age_yr*12, 
                 y=d #, colour=no_of_items_completed<4
                 )) +
  scale_x_continuous(name = "age (months)",
                     limits = c(0,65),
                     breaks = seq(0,65, by=10)
                     ) +
  scale_y_continuous(name = "d-score" #,
                     # limits = c(40,80),
                     # breaks = seq(40,80, by=10)
                     ) +
  xlab("age (months)")+ylab("d-score")  + 
  annotate("text", label=paste(nvisits_d, "visits from", n_d, "children", sep=" "), x=55, y=5, fontface="italic")
  # geom_line(data=ref_NL, aes(x=month, y=SDP2), colour="blue") +
  # geom_line(data=ref_NL, aes(x=month, y=SD0), colour="red") +
  # geom_line(data=ref_NL, aes(x=month, y=SDM2), colour="blue")

  

```



```{r, echo=FALSE}
# no. of visits in this plot:
nvisits_tonus_reflex_d <- nrow(togo_d[(is.na(togo_d$neuro.reflex)==FALSE) & (is.na(togo_d$neuro.tonus)==FALSE) & (is.na(togo_d$d)==FALSE),])
# of .. unique children:
n_tonus_reflex_d <- length(unique(togo_d[(is.na(togo_d$neuro.reflex)==FALSE) & (is.na(togo_d$neuro.tonus)==FALSE) & (is.na(togo_d$d)==FALSE),"id"]))

# as validation: 
# red colour for muscle tone and/or reflex-problems
ggplot(togo_d[(is.na(togo_d$neuro.reflex)==FALSE) & (is.na(togo_d$neuro.tonus)==FALSE),], 
       aes(x=age*12, y=d)) +
  geom_point() +
  geom_point(data=togo_d[(is.na(togo_d$neuro.reflex)==FALSE) & (is.na(togo_d$neuro.tonus)==FALSE),],
             aes(x=age*12, y=d, colour=(neuro.reflex==1|neuro.tonus==1) )) +
  scale_x_continuous(name = "age (months)",
                     limits = c(0,65),
                     breaks = seq(0,65, by=10)
  ) +
  scale_y_continuous(name = "d-score" #,
                     # limits = c(40,80),
                     # breaks = seq(40,80, by=10)
  ) +
  xlab("age (months)")+ylab("d-score") +
  scale_color_manual(breaks = c("FALSE", "TRUE"),
                     values=c("black", "red"),
                     labels=c("no reflex or muscle tone problems", "reflex and/or muscle tone problems"),
                     name="as observed by physician:")   + 
  annotate("text", label=paste(nvisits_tonus_reflex_d, "visits from", n_tonus_reflex_d, "children", sep=" "), 
           x=48, y=10,
           # x=-Inf,y=-Inf,
           # hjust=0, vjust=0,
           fontface="italic")

  
```


```{r, echo=FALSE}
# regression
# waz as predictor of daz
# figuur verderop (want na tekst); regressie hier zodat resultaten in tekst gebruikt kunnen worden

# data: last visit with daz, per child
# step 1: gender only (covariate)
regr10.1 <- lm(daz ~ male, data=togo_last) 
# step 2: add fathers' schooling (covariate)
regr10.2 <- lm(daz ~ male + prof_father_dich, data=togo_last)  
# step 3: add predictor of interest: waz
regr10.3 <- lm(daz ~ male + prof_father_dich + waz, data=togo_last)  

regr10.3.summary <- summary(regr10.3)
regr10.3.waz.coeff <- summary(regr10.3)$coefficients["waz",]

```

```{r, echo=FALSE}

# extra analysis relation waz and daz: 
# daz predicted by no. of children in family?
# data: last visit with daz, per child
# step 1: gender only (covariate)
regr6.1 <- lm(daz ~ male, data=togo_last)  
# step 2: add predictor of interest: no.of.children.father (5 or more vs 4 or less)
regr6.2 <- lm(daz ~ male + no.of.children.father.dich5, data=togo_last)  

regr6.2.summary <- summary(regr6.2)
regr6.2.no_of_children_father_dich5.coeff <- summary(regr6.2)$coefficients["no.of.children.father.dich5",]

```

In figure .. underweighted children are highlighted. Visually there seems to be a relation between being underweighted and having a lower than normal $D$-score. A regression based on data of children's last visit for which the DAZ-score could be calculated, showed that indeed the age-corrected weight z-score (waz), after correction for fathers' schooling and sex of the child, did predict the DAZ: a decrease of 1 SD in age-corrected weight was related to a decrease of `r round(regr10.3.waz.coeff["Estimate"],1) ` SD in age-corrected $D$-score (p `r format.pval(regr10.3.waz.coeff["Pr(>|t|)"], eps = .001) `), which is a reasonable effect. The overall model explained `r round(regr10.3.summary$adj.r.squared * 100,0)`% of the DAZ variance (adjusted R^2^). As in the other regression analyses sex and fathers' schooling did not contribute significantly to the model.
	Because there clearly seems to be a relation between underweight and a lower than normal $D$-score, it was also tested whether family size (which might be a cause of malnutrition) did predict the DAZ. No such relation was found: children from large families (5 or more children of the father at the moment of the first visit versus 4 or less children) did not have different DAZ-scores at their last visit than children from smaller families (after correction for sex: B = `r round(regr6.2.no_of_children_father_dich5.coeff["Estimate"],2)`, p = `r format.pval(regr6.2.no_of_children_father_dich5.coeff["Pr(>|t|)"], eps = .001, digits=2)`, adjusted R^2^ = `r round(regr6.2.summary$adj.r.squared,3)`).  
<!-- NOG CHECKEN: is het inderdaad 2zijdig getoetst? -->

```{r, echo=FALSE}
# aantal bezoeken in deze plot:
nvisits_waz_d <- nrow(togo_d[(is.na(togo_d$waz)==FALSE) & (is.na(togo_d$d)==FALSE),])
# van .. unieke kinderen:
n_waz_d <- length(unique(togo_d[(is.na(togo_d$waz)==FALSE) & (is.na(togo_d$d)==FALSE),"id"])) 

# in red: waz < (-2) (weight age-corrected z-score) 
ggplot() +
  geom_point(data=togo_d[is.na(togo_d$waz)==FALSE,],
             aes(x=age*12, 
                 y=d, 
                 colour=waz<(-2)
             )
  ) +
  scale_x_continuous(name = "age (months)",
                     limits = c(0,65),
                     breaks = seq(0,65, by=10)
  ) +
  scale_y_continuous(name = "d-score" #,
                     # limits = c(40,80),
                     # breaks = seq(40,80, by=10)
  ) +
  xlab("age (months)") + ylab("d-score") +
  scale_color_manual(breaks = c("FALSE", "TRUE"),
                     values=c("black", "red"),
                     labels=c("not underweighted (age-corrected zscore > -2)", 
                              "underweighted (age-corrected zscore < -2)"),
                     name="based on WHO reference data:")    + 
  annotate("text", label=paste(nvisits_waz_d, "visits from", n_waz_d, "children", sep=" "), 
           x=45, y=5,
           fontface="italic")


```
<!-- *`r nvisits_waz_d` visits from `r n_waz_d` children* -->




```{r, echo=FALSE}
# regression APGAR as predictor of daz
# figuur verderop (want na tekst); regressie hier zodat resultaten in tekst gebruikt kunnen worden

# data: last visit with daz, per child
# step 1: gender only (covariate)
regr2.1 <- lm(daz ~ male, data=togo_last)
# step 2: add fathers' schooling (covariate)
regr2.2 <- lm(daz ~ male + prof_father_dich, data=togo_last)
# step 3: add predictor of interest: apgar
regr2.3 <- lm(daz ~ male + prof_father_dich + apgar.10min.dich10, data=togo_last)

regr2.3.summary <- summary(regr2.3)
regr2.3.APGAR10min_dich10.coeff <- summary(regr2.3)$coefficients["apgar.10min.dich10",]

```

In figure .. $D$-scores of the children for who a 10-minute APGAR score was available are shown. A less than optimal 10-minute APGAR score (i.e. less than 10 points) did predict a lower DAZ at their last visit after correction for sex and father's schooling (B = `r format(round(regr2.3.APGAR10min_dich10.coeff["Estimate"],2), nsmall=2)`, p `r format.pval(regr2.3.APGAR10min_dich10.coeff["Pr(>|t|)"], eps = .001, digits=2)`, adjusted R^2^ = `r round(regr2.3.summary$adj.r.squared,3)`). So, children with a less than optimal APGAR score at ten minutes after birth, had somewhat lower $D$-scores.  
<!-- NOG CHECKEN: waarom is df zoveel kleiner dan 534? Komt dat door 'laatste visit'-selectie?   -->
<!-- en bij deze nog prematuriteit en evt. geb.gew toevoegen als covariaat? Kan dat dit vooral gaat over prematuur vs niet-prematuur # -->

For all regression analyses mentioned, results were similar when based on children's first visit.

```{r, echo=FALSE}
# no. of visits in plot:
nvisits_apgar10_d <- nrow(togo_d[(is.na(togo_d$apgar.10min)==FALSE) & (is.na(togo_d$d)==FALSE),])
# of .. unique children:
n_apgar10_d <- length(unique(togo_d[(is.na(togo_d$apgar.10min)==FALSE) & (is.na(togo_d$d)==FALSE),"id"]))    

# in red: apgar score below 10, 10min after birth
ggplot() +
  geom_point(data=togo_d[is.na(togo_d$apgar.10min)==FALSE,],
             aes(x=age*12, 
                 y=d, 
                 colour=apgar.10min<10
             )
  ) +
  scale_x_continuous(name = "age (months)",
                     limits = c(0,65),
                     breaks = seq(0,65, by=10)
  ) +
  scale_y_continuous(name = "d-score" #,
                     # limits = c(40,80),
                     # breaks = seq(40,80, by=10)
  ) +
  xlab("age (months)") + ylab("d-score")+
  scale_color_manual(breaks = c("FALSE", "TRUE"),
                     values=c("black", "red"),
                     labels=c("10 points at apgar 10 min",
                              "less than 10 points at apgar 10 min"),
                     name="")    + 
  annotate("text", label=paste(nvisits_apgar10_d, "visits from", n_apgar10_d, "children", sep=" "), 
           x=50, y=10,
           fontface="italic")


```  
 <!-- *`r nvisits_apgar10_d` visits from `r n_apgar10_d` children*  -->

 

**Discussion and conclusions**  

In this study we examined the validity and usability of the $D$-score in low income country Togo. The $D$-score does seem to be informative in this country. The $D$-score did increase with age, and for the majority of the children $D$-scores were very similar within their age group. It is notable that there were also several children with much lower $D$-scores when compared with their age mates. This does not seem to be an artifact of the data or of the measures, as the majority of these children were observed to have muscle tension and/or reflex problems. So, it is plausible that these children indeed had developmental problems. Furthermore, health factors that were expected to be related to having a lower $D$-score were found to be significant predictors: a less than optimal APGAR score 10 minutes after birth, and a lower than normal weight at the time of the assessment were related to a lower than normal $D$-score. Especially the relation between weight and $D$-score was quite strong, as the model with age-corrected weight, sex and father's schooling explained 18% of the variance in age-corrected $D$-score. The positive relation between weight and $D$-score, as well as the fact that children were often underweighted in this population, seems to indicate that being underweighted is a risk factor for developmental problems. The main physician of the medical center noted that not many children with extreme underweight were seen, but our results do indicate that also less than severe underweight does have a negative impact on the development of children.  
	The idea that having many children in the family would be related to having a lower $D$-score (due to possible malnutrition), was not supported. This might mean that there is no clear relation between living in a large family and being underweighted, or that we did not have enough power to detect this, as there were not that many children from large families.  
Neither sex nor father's schooling did significantly contribute to variance in age-corrected $D$-scores. For sex at this young ages, this is consistent with results found in other studies (… refs…). Parents' schooling has been found to be related to $D$-scores in other studies (… refs..); that it was not in the present study might have to do with the population, or with the current method where it was estimated whether the parent was schooled based on profession. Many fathers had a profession other than the thirteen most common professions and were estimated to have no schooling, which might not be correct for part of this group.  
	A limitation of the present study is that our sample might not be representative of children in a low income country, or even of children in Togo. Especially the fact that many children came to the medical center because they were ill might mean that they are not representative in terms of general development and other measures. However, the current goal was to examine the validity and usability of the $D$-score in a low income country, and the result that, even though many children were ill, the $D$-score is clearly related to neurological problems (as indicated by reflex, and/or muscle tension problems), age, APGAR score as a newborn and weight does show that the $D$-score ís informative in a low income country as well.  

  
  
  
<!-- Evt nog doen:   -->
<!-- -	Na overleg met Cécile Schat: zij zagen heel weinig echte ondervoeding; wel is lichaamsbouw daar zeer tenger; wat gebeurt er als je ipv ondergewicht 'voedingstoestand geobserveerd door arts' neemt als predictor? Betere indicator van ondervoeding is bovendien: specifieke vorm van bloedarmoede; die variabele zit er ook in; zegt ook iets over eenzijdig eten in plaats van simpelweg te weinig (volgens Cécile Schat komt eenzijdig wel veel voor; te weinig niet)   -->
<!-- -	Gestational age en gebgewicht variabelen naar juiste dataset overhevelen zodat die ook gebruikt kunnen worden (GEDAAN; gebruiken om te laten zien dat verband APGAR-score niet verklaard wordt door prematuriteit?) -->



## Comparison


```{r, echo=FALSE}

# base reference lines on:
ref_NL <- dscore::Dreference # dutch reference group

# togo, whole group, all visits (can be more per child)
ggplot() +
  geom_point(data=togo_d,
             aes(x=age*12, # age in months
                 y=d)) +
  scale_x_continuous(name = "age (months)",
                     limits = c(0,65),
                     breaks = seq(0,65, by=10)
                     ) +
  scale_y_continuous(name = "d-score" #,
                     # limits = c(40,80),
                     # breaks = seq(40,80, by=10)
                     ) +
  xlab("age (months)")+ylab("d-score") +
   geom_line(data=ref_NL, aes(x=month, y=SDP2), colour="blue", size=1.5) +
   geom_line(data=ref_NL, aes(x=month, y=SD0), colour="red", size=1.5) +
   geom_line(data=ref_NL, aes(x=month, y=SDM2), colour="blue", size=1.5)
```
