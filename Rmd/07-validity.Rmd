# Validity {#ch:validity}

Validity is a generic term that refers to the question how well an
instrument measures what it claims to measure. There are many various
aspect of validity. The chapter we briefly review the main types of
validity:

* Internal validity (\@ref(sec:internal))
* External validity (\@ref(sec:external))


```{r init07, include=FALSE}
library(ddata)
library(dmetric)
library(dscore)
library(dinstrument)
library(gseddata)
library(dplyr)
library(tidyr)
library(RColorBrewer)
```

```{r smoccdata5, echo = FALSE, warning = FALSE}
library(gseddata)
library(dmetric)
data <- get_data(cohorts = 53)
items <- get_itemnames(data)
```

```{r smoccfit5, echo = FALSE, warning = FALSE}
varlist <- list(adm = c("cohort", "subjid", "agedays"), 
                items = items,
                cov = NULL)
model <- fit_dmodel(varlist, data, name = "57_0")
```

## Internal validity {#sec:internal}

### Content validity

Content validity is the extent to which the D-score represents all
facets of development. In contrast to "face validity", which assesses
whether the test appears valid to respondents, content validity is
about what is actually measured. 

One important form of content validity is that we wish to make sure
that the measurement scale represents the various developmental
domains in a fair way. In the simplest case, we can assign each
milestone uniquely to one domain, and evaluate coverage by splitting
the cumulative item information over domains.

```{r plotcontent, echo=FALSE, fig.height=3, fig.show='hold', message=FALSE, warning=FALSE, fig.cap = '(ref:plotcontent)'}
    info_data <-
      info_d_item(
        itembank = model$itembank,
        delta = "tau",
        long = TRUE,
        beta_range = 0:80
      )
    dom_data <- info_data %>% 
          mutate(domain = gseddata::decompose_itemnames(lex_gsed)[, "domain"],
                 domain = plyr::revalue(domain, c("cm" = "Communication", 
                                          "fm" = "Fine motor",
                                          "gm" = "Gross motor")))
    ggplot(data = dom_data, aes(x = ability, y = info, fill = domain)) +
      geom_bar(stat = "identity") +
      ylab("Item information") +
      xlab("Ability (D-score)")

```

(ref:plotcontent) Cumulative item information by DDI domain.

Figure \@ref(fig:plotcontent) shows how well each of the three domains
of the DDI are covered at various levels of the $D$-score.

### Construct validity

Construct validity is the extent to which the $D$-score behaves like
the theory says the construct should behave. For example, we expect
that child development advances with by age. Figure \@ref(fig:smoccda)
actually confirms that the $D$-score increases fastest in the first
six months and keeps increasing, but slower, as children age. This is
consistent with theories in growth and child development.

## External validity {#sec:external}

### Discriminatory validity

---
# >> achtergrondvariabelen gebruiken zoals opleidingsniveau ? Disclamer toevoegen dat de informatie ind e data summier is, maar dat we nog wel meer zouden willen toevoegen. 
---

With discriminatory validity, we indicate the extend to which the
D-score can discriminate repondents that are not developing normally
from respondents that are normally developing. This can be evaluated
by deviding respondents for who we know that development lags as
indicated by another measure, for example reflex and/or tonus problems
in a population form Togo (Chapter 8).  The D-score should be able to
discriminate between these two types of respondents accurately.


```{r plotdiscr, eval=FALSE, echo=FALSE, fig.height=3, fig.show='hold', message=FALSE, warning=FALSE}
plotdat <- left_join(model$dscore, data$visit) %>%
  mutate(agemos = agedays /365.25 * 12,
         edumocat = factor(edumocat, labels = c("none", "primary", "secondary", "above secondary")),
         residence = factor(residence, labels = c("semi-urban", "urban", "metropolitan")))

ggplot(plotdat, aes(x = agemos, y = b, group = edumocat, colour = edumocat))+
  geom_point()+
  xlab("Age (months)")+
  ylab("D-score")


ggplot(plotdat, aes(x = agemos, y = b, group = residence, colour = residence))+
  geom_point()+
  xlab("Age (months)")+
  ylab("D-score")

```



### Convergent validity

Convergent validity is the extend to which the D-score relates to
other similar constructs and can be measured as the correlation with
other tests that are assumed to measure the same thing. Examples are
the total score for Bayley-III or the Denver, which are both 
instruments to measure early child development. This is
similar to concurrent validity. For a good convergent validity the
correlation to other construct should be at least 0.6. Unforetunatly,
only limited data are available for teh DDI, so convergent validity 
for the D-score cannot be assessed at this point. 

Another option is to evaluate the extend to which the D-score relates
to measures that are currently used as a proxy for child development, 
such as stunting (height) (see section \@ref(sec:stunting)).


```{r plotconcurrent, eval=TRUE, echo=FALSE, fig.height=3, fig.show='hold', message=FALSE, warning=FALSE}
cor1dat <- left_join(model$dscore, data$visit)%>% mutate(daz = dscore::daz(b, 
            x = .data$agedays, x.unit = "day"))
cor1 <- round(cor(cor1dat[,c("b", "htcm")], use = "complete.obs")[1,2],2)
cor2 <- round(cor(cor1dat[,c("daz", "haz")], use = "complete.obs")[1,2],2)


plot_d_adm(data = data, model = model, metric = "dscore", adm_list = "htcm", show_legend = FALSE, show_cor = FALSE)[[1]]+
  annotate("text", x = 60, y = 5, hjust = 0, label = paste("correlation =", cor1))+
  ylab("Height (cm)")


#plot_d_adm(data = data, model = model, metric = "daz", adm_list = "haz", show_legend = FALSE, show_cor = FALSE)[[1]]+
#  annotate("text", x = 2, y = -5.5, hjust = 0, label = paste("correlation =", cor2))+
#  ylab("z-score for height")+
#  xlab("z-score for D")



```



### Predictive validity

Predictive validity refers to the degree to which the D-score predicts
score on a criterion that is measured late rin time. For the D-score
we have measures for IQ at the age of 5 as a possible criterion.
Subsequently, for other examples we have other criteria. In Chapter 8,
some examples are presented.
